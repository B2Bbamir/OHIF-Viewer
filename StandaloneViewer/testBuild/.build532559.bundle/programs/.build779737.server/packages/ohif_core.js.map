{"version":3,"sources":["meteor://ðŸ’»app/packages/ohif:core/main.js","meteor://ðŸ’»app/packages/ohif:core/both/index.js","meteor://ðŸ’»app/packages/ohif:core/both/schema.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/index.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/object.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getAttribute.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getAuthorizationHeader.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getModalities.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getName.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getNumber.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/getString.js","meteor://ðŸ’»app/packages/ohif:core/both/lib/DICOMWeb/index.js","meteor://ðŸ’»app/packages/ohif:core/both/utils/absoluteUrl.js","meteor://ðŸ’»app/packages/ohif:core/both/utils/index.js","meteor://ðŸ’»app/packages/ohif:core/both/utils/objectPath.js"],"names":["module","export","OHIF","Meteor","watch","require","v","log","ui","utils","viewer","cornerstone","user","DICOMWeb","isClient","window","SimpleSchema","extendOptions","valuesLabels","Match","Optional","String","textOptional","Boolean","addValidator","definition","optional","value","messages","maxCount","minCount","notAllowed","object","getNestedObject","shallowObject","nestedObject","key","hasOwnProperty","propertyArray","split","currentObject","length","currentProperty","shift","getShallowObject","putValues","baseKey","resultObject","currentKey","currentValue","Array","default","getAttribute","element","defaultValue","Value","convertToInt","input","padFour","l","output","i","j","charCodeAt","toString","parseInt","getAuthorizationHeader","btoa","headers","accessToken","getAccessToken","server","servers","getCurrentServer","requestOptions","auth","Authorization","getModalities","modality","modalitiesInStudy","modalities","vr","indexOf","push","getName","Alphabetic","getNumber","parseFloat","getString","join","productionMode","isDevelopment","absoluteUrl","path","absolutePath","absoluteUrlParts","rootUrlPrefixIndex","substring","replace","viewerUrl","Session","get","ObjectPath","set","components","getPathComponents","result","isValidObject","last","field","found","isValid","Object"],"mappings":"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","file":"/packages/ohif_core.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\n\n/*\n * Defines the base OHIF object\n */\n\nconst OHIF = {\n    log: {},\n    ui: {},\n    utils: {},\n    viewer: {},\n    cornerstone: {},\n    user: {},\n    DICOMWeb: {}, // Temporarily added\n};\n\n// Expose the OHIF object to the client if it is on development mode\n// @TODO: remove this after applying namespace to this package\nif (Meteor.isClient) {\n    window.OHIF = OHIF;\n}\n\nexport { OHIF };\n","import './lib';\nimport './utils';\n\nimport './schema.js';\n","import { SimpleSchema } from 'meteor/aldeed:simple-schema';\n\n/*\n Extend the available options on schema definitions:\n\n  * valuesLabels: Used in conjunction with allowedValues to define the text\n    label for each value (used on forms)\n\n  * textOptional: Used to allow empty strings\n\n */\nSimpleSchema.extendOptions({\n    valuesLabels: Match.Optional([String]),\n    textOptional: Match.Optional(Boolean)\n});\n\n// Add default required validation for empty strings which can be bypassed\n// using textOptional=true definition\nSimpleSchema.addValidator(function() {\n    if (\n        this.definition.optional !== true &&\n        this.definition.textOptional !== true &&\n        this.value === ''\n    ) {\n        return 'required';\n    }\n});\n\n// Including [label] for some messages\nSimpleSchema.messages({\n    maxCount: '[label] can not have more than [maxCount] values',\n    minCount: '[label] must have at least [minCount] values',\n    notAllowed: '[label] has an invalid value: \"[value]\"'\n});\n","import './object.js';\nimport './DICOMWeb/';\n","import { OHIF } from 'meteor/ohif:core';\n\nOHIF.object = {};\n\n// Transforms a shallow object with keys separated by \".\" into a nested object\nOHIF.object.getNestedObject = shallowObject => {\n    const nestedObject = {};\n    for (let key in shallowObject) {\n        if (!shallowObject.hasOwnProperty(key)) continue;\n        const value = shallowObject[key];\n        const propertyArray = key.split('.');\n        let currentObject = nestedObject;\n        while (propertyArray.length) {\n            const currentProperty = propertyArray.shift();\n            if (!propertyArray.length) {\n                currentObject[currentProperty] = value;\n            } else {\n                if (!currentObject[currentProperty]) {\n                    currentObject[currentProperty] = {};\n                }\n\n                currentObject = currentObject[currentProperty];\n            }\n        }\n    }\n\n    return nestedObject;\n};\n\n// Transforms a nested object into a shallowObject merging its keys with \".\" character\nOHIF.object.getShallowObject = nestedObject => {\n    const shallowObject = {};\n    const putValues = (baseKey, nestedObject, resultObject) => {\n        for (let key in nestedObject) {\n            if (!nestedObject.hasOwnProperty(key)) continue;\n            let currentKey = baseKey ? `${baseKey}.${key}` : key;\n            const currentValue = nestedObject[key];\n            if (typeof currentValue === 'object') {\n                if (currentValue instanceof Array) {\n                    currentKey += '[]';\n                }\n\n                putValues(currentKey, currentValue, resultObject);\n            } else {\n                resultObject[currentKey] = currentValue;\n            }\n        }\n    };\n\n    putValues('', nestedObject, shallowObject);\n    return shallowObject;\n};\n","/**\n * Returns the specified element as a dicom attribute group/element.\n *\n * @param element - The group/element of the element (e.g. '00280009')\n * @param [defaultValue] - The value to return if the element is not present\n * @returns {*}\n */\nexport default function getAttribute(element, defaultValue) {\n    if (!element) {\n        return defaultValue;\n    }\n    // Value is not present if the attribute has a zero length value\n    if (!element.Value) {\n        return defaultValue;\n    }\n    // Sanity check to make sure we have at least one entry in the array.\n    if (!element.Value.length) {\n        return defaultValue;\n    }\n\n    return convertToInt(element.Value);\n};\n\nfunction convertToInt(input) {\n    function padFour(input) {\n        var l = input.length;\n\n        if (l == 0) return '0000';\n        if (l == 1) return '000' + input;\n        if (l == 2) return '00' + input;\n        if (l == 3) return '0' + input;\n\n        return input;\n    }\n\n    var output = '';\n    for (var i = 0; i < input.length; i++) {\n        for (var j = 0; j < input[i].length; j++) {\n            output += padFour(input[i].charCodeAt(j).toString(16));\n        }\n    }\n\n    return parseInt(output, 16);\n}\n","import { OHIF } from 'meteor/ohif:core';\nimport { btoa } from 'isomorphic-base64';\n\n/**\n * Returns the Authorization header as part of an Object.\n *\n * @returns {Object}\n */\nexport default function getAuthorizationHeader() {\n    const headers = {};\n\n    // Check for OHIF.user since this can also be run on the server\n    const accessToken = OHIF.user && OHIF.user.getAccessToken && OHIF.user.getAccessToken();\n    const server = OHIF.servers.getCurrentServer();\n\n    if (server &&\n        server.requestOptions &&\n        server.requestOptions.auth) {\n        // HTTP Basic Auth (user:password)\n        headers.Authorization = `Basic ${btoa(server.requestOptions.auth)}`;\n    } else if (accessToken) {\n        headers.Authorization = `Bearer ${accessToken}`;\n    }\n\n    return headers;\n}\n","export default function getModalities(modality, modalitiesInStudy) {\n    var modalities = {};\n    if (modality) {\n        modalities = modality;\n    }\n\n    if (modalitiesInStudy) {\n        // Find vr in modalities\n        if (modalities.vr && modalities.vr === modalitiesInStudy.vr) {\n            for (var i = 0; i < modalitiesInStudy.Value.length; i++) {\n                var value = modalitiesInStudy.Value[i];\n                if (modalities.Value.indexOf(value) === -1) {\n                    modalities.Value.push(value);\n                }\n            }\n        } else {\n            modalities = modalitiesInStudy;\n        }\n    }\n    return modalities;\n};\n","/**\n * Returns the Alphabetic version of a PN\n *\n * @param element - The group/element of the element (e.g. '00200013')\n * @param [defaultValue] - The default value to return if the element is not found\n * @returns {*}\n */\nexport default function getName(element, defaultValue) {\n    if (!element) {\n        return defaultValue;\n    }\n    // Value is not present if the attribute has a zero length value\n    if (!element.Value) {\n        return defaultValue;\n    }\n    // Sanity check to make sure we have at least one entry in the array.\n    if (!element.Value.length) {\n        return defaultValue;\n    }\n    // Return the Alphabetic component group\n    if (element.Value[0].Alphabetic) {\n        return element.Value[0].Alphabetic;\n    }\n    // Orthanc does not return PN properly so this is a temporary workaround\n    return element.Value[0];\n};\n","/**\n * Returns the first string value as a Javascript Number\n * @param element - The group/element of the element (e.g. '00200013')\n * @param [defaultValue] - The default value to return if the element does not exist\n * @returns {*}\n */\nexport default function getNumber(element, defaultValue) {\n    if (!element) {\n        return defaultValue;\n    }\n    // Value is not present if the attribute has a zero length value\n    if (!element.Value) {\n        return defaultValue;\n    }\n    // Sanity check to make sure we have at least one entry in the array.\n    if (!element.Value.length) {\n        return defaultValue;\n    }\n\n    return parseFloat(element.Value[0]);\n};\n","/**\n * Returns the specified element as a string.  Multi-valued elements will be separated by a backslash\n *\n * @param element - The group/element of the element (e.g. '00200013')\n * @param [defaultValue] - The value to return if the element is not present\n * @returns {*}\n */\nexport default function getString(element, defaultValue) {\n    if (!element) {\n        return defaultValue;\n    }\n    // Value is not present if the attribute has a zero length value\n    if (!element.Value) {\n        return defaultValue;\n    }\n    // Sanity check to make sure we have at least one entry in the array.\n    if (!element.Value.length) {\n        return defaultValue;\n    }\n    // Join the array together separated by backslash\n    // NOTE: Orthanc does not correctly split values into an array so the join is a no-op\n    return element.Value.join('\\\\');\n};\n","import { OHIF } from 'meteor/ohif:core';\n\nimport getAttribute from './getAttribute.js';\nimport getAuthorizationHeader from './getAuthorizationHeader.js';\nimport getModalities from './getModalities.js';\nimport getName from './getName.js';\nimport getNumber from './getNumber.js';\nimport getString from './getString.js';\n\nconst DICOMWeb = {\n    getAttribute,\n    getAuthorizationHeader,\n    getModalities,\n    getName,\n    getNumber,\n    getString,\n};\n\nOHIF.DICOMWeb = DICOMWeb;\n","import { OHIF } from \"meteor/ohif:core\";\n\nconst productionMode = true;\n\nif (Meteor.isDevelopment) {\n  // Return an absolute URL with the page domain using sub path of ROOT_URL\n  // to let multiple domains directed to the same server work\n\n  OHIF.utils.absoluteUrl = function(path) {\n    // For local testing.\n    let absolutePath = \"/\";\n\n    const absoluteUrl = Meteor.absoluteUrl();\n    const absoluteUrlParts = absoluteUrl.split(\"/\");\n\n    if (absoluteUrlParts.length > 4) {\n      const rootUrlPrefixIndex = absoluteUrl.indexOf(absoluteUrlParts[3]);\n      absolutePath += absoluteUrl.substring(rootUrlPrefixIndex) + path;\n    } else {\n      absolutePath += path;\n    }\n\n    return absolutePath.replace(/\\/\\/+/g, \"/\");\n  };\n} else {\n  // JPETTS -- Override this function in XNAT enviornment in order to display correctly when hosted at an arbitrary subdirectory in XNAT.\n  OHIF.utils.absoluteUrl = function(path) {\n    let viewerUrl = Session.get(\"viewerRoot\");\n\n    if (path[0] === \"/\") {\n      return `${viewerUrl}${path}`;\n    }\n\n    return `${viewerUrl}/${path}`;\n  };\n}\n","import './absoluteUrl';\nimport './objectPath';\n","import { OHIF } from 'meteor/ohif:core';\n\nclass ObjectPath {\n\n    /**\n     * Set an object property based on \"path\" (namespace) supplied creating\n     * ... intermediary objects if they do not exist.\n     * @param object {Object} An object where the properties specified on path should be set.\n     * @param path {String} A string representing the property to be set, e.g. \"user.study.series.timepoint\".\n     * @param value {Any} The value of the property that will be set.\n     * @return {Boolean} Returns \"true\" on success, \"false\" if any intermediate component of the supplied path\n     * ... is not a valid Object, in which case the property cannot be set. No excpetions are thrown.\n     */\n    static set(object, path, value) {\n\n        let components = ObjectPath.getPathComponents(path),\n            length = components !== null ? components.length : 0,\n            result = false;\n\n        if (length > 0 && ObjectPath.isValidObject(object)) {\n\n            let i = 0,\n                last = length - 1,\n                currentObject = object;\n\n            while (i < last) {\n\n                let field = components[i];\n\n                if (field in currentObject) {\n                    if (!ObjectPath.isValidObject(currentObject[field])) {\n                        break;\n                    }\n                } else {\n                    currentObject[field] = {};\n                }\n\n                currentObject = currentObject[field];\n                i++;\n\n            }\n\n            if (i === last) {\n                currentObject[components[last]] = value;\n                result = true;\n            }\n\n        }\n\n        return result;\n\n    }\n\n    /**\n     * Get an object property based on \"path\" (namespace) supplied traversing the object\n     * ... tree as necessary.\n     * @param object {Object} An object where the properties specified might exist.\n     * @param path {String} A string representing the property to be searched for, e.g. \"user.study.series.timepoint\".\n     * @return {Any} The value of the property if found. By default, returns the special type \"undefined\".\n     */\n    static get(object, path) {\n\n        let found, // undefined by default\n            components = ObjectPath.getPathComponents(path),\n            length = components !== null ? components.length : 0;\n\n        if (length > 0 && ObjectPath.isValidObject(object)) {\n\n            let i = 0,\n                last = length - 1,\n                currentObject = object;\n\n            while (i < last) {\n\n                let field = components[i];\n\n                const isValid = ObjectPath.isValidObject(currentObject[field]);\n                if (field in currentObject && isValid) {\n                    currentObject = currentObject[field];\n                    i++;\n                } else {\n                    break;\n                }\n\n            }\n\n            if (i === last && components[last] in currentObject) {\n                found = currentObject[components[last]];\n            }\n\n        }\n\n        return found;\n\n    }\n\n    /**\n     * Check if the supplied argument is a real JavaScript Object instance.\n     * @param object {Any} The subject to be tested.\n     * @return {Boolean} Returns \"true\" if the object is a real Object instance and \"false\" otherwise.\n     */\n    static isValidObject(object) {\n        return (\n            typeof object === 'object' &&\n            object !== null &&\n            object instanceof Object\n        );\n    }\n\n    static getPathComponents(path) {\n        return (typeof path === 'string' ? path.split('.') : null);\n    }\n\n}\n\nOHIF.utils.ObjectPath = ObjectPath;\n"]}